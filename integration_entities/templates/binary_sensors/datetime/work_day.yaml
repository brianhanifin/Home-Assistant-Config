---
unique_id: work_day
name: Work day
icon: "mdi:briefcase{{ '-off' if is_state('binary_sensor.work_day','off') }}"
state: |
  {%- set today = now().date() %}
  {%- set daysofweek = ["mon","tue","wed","thu","fri","sat","sun"] %}
  {%- set today_name = daysofweek[today.isoweekday()-1] %}
  {%- set workdays = ["sun","mon","tue","wed","thu"] %}

  {%- set event = namespace(name="", date="") %}
  {%- set skipevents = ["Vacation","Nerene has day off","Nerene has days off","Nerene has training"] %}
  {%- set event.name = state_attr("calendar.nerene","message") %}
  {%- set event.date = state_attr("calendar.nerene","start_time")|as_datetime %}
  {%- set event.date = event.date.month ~ "-" ~ event.date.day %}
  {%- set today = today.month ~ "-" ~ today.day %}
  {%- set skiptoday = (today == event.date and event.name in skipevents) %}
  {{
    today_name in workdays and
    not skiptoday
  }}

# {%- set daysoff = [
#     "2022-06-20",
#     "2022-06-21",
#     "2022-06-22",
#     "2022-06-23",
#     "2022-06-24",
#     "2022-06-25",
#     "2022-06-26",
#     "2022-06-27",
#     "2022-06-28",
#     "2022-06-29",
#     "2022-06-30",
#     "2022-07-01",
#     "2022-07-02",
#     "2022-07-03",
#     "2022-07-04",
#     "2022-07-05",
#     "2022-07-06",
#     "2022-07-07",
#     "2022-07-08",
#     "2022-07-09",
#     "2022-07-10",
#     "2022-07-11",
#     "2022-07-12",
#     "2022-07-13",
#     "2022-07-14",
#     "2022-07-15",
#     "2022-07-16",
#     "2022-07-17",
#     "2022-07-18",
#     "2022-07-19",
#     "2022-07-20",
#     "2022-07-21",
#     "2022-07-22",
#     "2022-07-23",
#     "2022-07-24",
#     "2022-07-25",
#     "2022-07-26",
#     "2022-07-27",
#     "2022-07-28",
#     "2022-07-29"
#   ] %}
# {{
#   today_name in workdays and
#   today not in daysoff
# }}
